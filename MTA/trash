In HTC Vive handheld controllers, haptic feedback is generated by the built-in vibrators. In every rendering frame, the intensity value can be sent to each controller.
The haptic pulse intensity based on friction is calculated as:

\begin{equation}
k_{f} = k_{0} + \epsilon \cdot k_{\mu}
\end{equation}
where $k_{0}$ is the minimum friction intensity when user just touches the clay, and $\epsilon \in [0,1]$ is analog value of the trigger button. $k_{\mu}$ is the predefined intensity coefficient based on the coefficient of friction $\mu$.
%%%

%%%
According to Newton's third law of classical mechanics, the forces between the hand and the clay exist in equal magnitude and opposite direction.
Hence, the reaction force $\mathbf{F}_{r}$ can be calculated based on the movement of the controller using Newton's Second Law:

\begin{equation}
\mathbf{F}_{r} = -\mathbf{F}_{c} = -m \frac{\mathrm{d} \mathbf{v}}{\mathrm{d} t}
\end{equation}


where $\mathbf{F}_{c}$ is the force exerted by the controller on the clay; $\mathbf{v}$ is the velocity of the controller; $m$ is the mass of the controller.
The reaction haptic intensity $k_{r}$ in each frame can be calculated based on the consecutive controller positions in the last three frames:

\begin{equation}
k_{r} = k_{\nu} \cdot \|\mathbf{v} - \mathbf{v}'\| = k_{\nu} \cdot \|(\mathbf{x}-\mathbf{x}') - (\mathbf{x}'-\mathbf{x}'')\| = k_{\nu} \cdot \|\mathbf{x}-2\mathbf{x}'+\mathbf{x}''\|
\end{equation}


Since the haptic controllers used in our system are vibration-based rather than a 3-DOF force-based devices, approximation was made to calculate the haptic intensity.